version: "3.8"
services:
  timescaledb:
    image: timescale/timescaledb-ha:pg14-latest
    ports:
      - "5555:5432"
    environment:
      - POSTGRES_PASSWORD=postgres
    volumes:
      - timescaledb:/home/postgres/pgdata/data

  backend:
    build:
      context: ./backend
      dockerfile: ../support/backend/Dockerfile
    volumes:
      - ./backend:/app
    ports:
      - "5000:8080"
      - "5345:2345"
    depends_on:
      - timescaledb

  car-integration:
    build:
      context: ./car-integration
    ports:
      - "6060:6060"
    depends_on:
      - timescaledb
      
  decision-module:
    build:
      context: ./decision-module
    links:
      - car-integration
    ports:
      - "60:60"
    depends_on:
      - timescaledb


volumes:
  timescaledb: